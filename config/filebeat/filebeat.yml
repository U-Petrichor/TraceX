# /root/TraceX/config/filebeat/filebeat.yml

# ============================== Filebeat Inputs ===============================
filebeat.inputs:
- type: log
  enabled: true
  # 这里的路径必须是 Filebeat 容器内的绝对路径
  # 对应 docker-compose.yml 中的 - zeek-logs:/var/log/zeek:ro
  paths:
    - /var/log/zeek/*.log
  
  # 关键标记：用于分析引擎区分数据源
  fields:
    dataset: "zeek"
  fields_under_root: true

# ================================== Outputs ===================================

output.elasticsearch:
  # 这里的 hosts 使用 docker-compose 中的服务名
  hosts: ["elasticsearch:9200"]
  
  # 索引名称格式符合项目统一规范
  index: "unified-logs-%{+yyyy.MM.dd}"

# ================================== Setup =====================================
setup.template.name: "unified-logs"
setup.template.pattern: "unified-logs-*"
setup.ilm.enabled: false